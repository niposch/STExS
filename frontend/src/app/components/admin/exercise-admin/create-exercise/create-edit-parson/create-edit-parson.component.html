<mat-card class="main-mat-card">
    <div *ngIf="!this.loading else loadingSpinner">
      <div class="horizontal-container card-title" style="align-items: center">
        <div class="horizontal-container" style="align-items: center">
          <button mat-icon-button (click)="goBack()" style="margin-right: 10px"><mat-icon>arrow_back</mat-icon></button>
          <mat-card-title class="vertically-centered" style="margin-top: 0; margin-bottom: 0">Create a new Parson Puzzle Exercise</mat-card-title>
        </div>
        <button *ngIf="!isEditingExercise" mat-raised-button color="accent" class="create-button" (click)="createExercise()">create</button>
        <button *ngIf="isEditingExercise" mat-raised-button color="accent" class="create-button" (click)="updateExercise()">update</button>
      </div>
      <mat-card-content>
        <mat-divider style="margin-top: 5px; margin-bottom: 5px"></mat-divider>
        <app-create-exercise [(description)]="this.description" [(name)]="this.name" ></app-create-exercise>
        <mat-divider style="margin-top: 5px; margin-bottom: 5px"></mat-divider>
        
        <!--drag drop-->
        <div cdkDropListGroup>
          <!--add puzzle-->
          <div class="drag-container">
            <h2>Add Element</h2>
            <div
              cdkDropList
              #create_puzzle_list="cdkDropList"
              [cdkDropListData]="create_puzzles"
              id="create_puzzle_list"
              class="drag-list drop-list"
              (cdkDropListDropped)="drop($event)" >
              <div class="drag-box" >
                <div class="drag-item"  *ngIf="isEditingPuzzleName" >
                  <!-- editing puzzle -->
                  <mat-form-field class="input-field" style="margin-bottom: -28px; margin-top: -2px">
                    <mat-label>Puzzle Name</mat-label>
                    <input class="name-input" matInput name="text" required placeholder="{{puzzleName}}" [(ngModel)]="newPuzzleName" type="text">
                  </mat-form-field>
                  
                  <button mat-mini-fab aria-label="Example icon button with a home icon" class="" (click)="createPuzzle()">
                    <mat-icon>check</mat-icon>
                  </button>
                </div>
                <!--editing finished-->
                <!--now draging-->
                <div class="drag-box"  *ngIf="!isEditingPuzzleName" cdkDrag (cdkDragEntered)="onCdkDragEntered($event)">
                  <ng-template #itemTpl>
                    <div class="drag-item">
                      {{create_puzzles[0]}}
                      <mat-icon>drag_handle</mat-icon>
                    </div>
                  </ng-template>
                  <div *cdkDragPlaceholder>
                    <div *ngIf="draggingOutsideSourceList; else itemTpl" class="custom-dragover-placeholder">
                      <div class="center-container">
                        <mat-icon>delete_outline</mat-icon>
                      </div>
                    </div>
                  </div>
                  <ng-container *ngTemplateOutlet="itemTpl"></ng-container>
                </div>
              </div>
            </div>
          </div>
          <!--parson puzzle-->
          <div class="drag-container">
            <h2>Parson Puzzle</h2>
            <div
              cdkDropList
              #puzzle_list="cdkDropList"
              [cdkDropListData]="puzzles"
              [cdkDropListConnectedTo]="[puzzle_list]"
              id="puzzle_list"
              class="drag-list"
              (cdkDropListDropped)="drop($event)">
                <div class="drag-box" *ngFor="let piece of puzzles" cdkDrag (cdkDragEntered)="onCdkDragEntered($event)">
                  <ng-template #itemTpl>
                    <div class="drag-item">
                      {{piece}}
                      <mat-icon>drag_handle</mat-icon>
                    </div>
                  </ng-template>
                  <div *cdkDragPlaceholder>
                    <div *ngIf="draggingOutsideSourceList; else itemTpl" class="custom-dragover-placeholder">
                      <div class="center-container">
                        <mat-icon>delete_outline</mat-icon>
                      </div>
                    </div>
                  </div>
                  <ng-container *ngTemplateOutlet="itemTpl"></ng-container>
              </div>
            </div>
          </div>
          <!--delete puzzle-->
          <div class="drag-container">
            <h2>Delete Element</h2>
            <div
              cdkDropList
              #delete_puzzle_list="cdkDropList"
              [cdkDropListData]="empty"
              id="delete_puzzle_list"
              class="drag-list drop-list"
              (cdkDropListDropped)="drop($event)" >

              <div *ngIf="!draggingOutsideSourceList;"class="center-container min-height-container">
                <mat-icon>delete_outline</mat-icon>
              </div>
            </div>
          </div>
        </div>
  
        <mat-divider style="margin-top: 5px; margin-bottom: 5px"></mat-divider>
  
        <div class="horizontal-container vertically-centered">
          <div class="vertical-container form-field-container checkbox-container">
            <mat-checkbox class="vertically-centered" [(ngModel)]="this.isMultilineResponse">allow multiline response</mat-checkbox>
          </div>
          <div class="form-field-container">
            <mat-form-field class="form-field">
              <mat-label>Achievable Points</mat-label>
              <input matInput type="number" [(ngModel)]="this.achievablePoints">
            </mat-form-field>
          </div>
        </div>
      </mat-card-content>

    </div>
    <ng-template #loadingSpinner>
      <mat-spinner mode="indeterminate" style="scale: 0.5"></mat-spinner>
    </ng-template>
  </mat-card>
  